<Page x:Class="OptiScaler.UI.Views.AppSettingsPage"
      x:Name="RootPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      Background="Transparent">
    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
        <Grid RowSpacing="24" Padding="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid x:Name="HeaderGrid" Grid.Row="0" Height="110" CornerRadius="12" Background="{StaticResource HeroGradient}">
                <StackPanel VerticalAlignment="Center" Padding="32,0" Spacing="6">
                    <TextBlock Text="App Settings" FontSize="32" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Application preferences, game scanning configuration, and system information" FontSize="16" Foreground="#CCFFFFFF"/>
                </StackPanel>
            </Grid>

            <!-- Navigation -->
            <NavigationView Grid.Row="1"
                             x:Name="SettingsNavView"
                             PaneTitle="Settings"
                             IsSettingsVisible="False"
                             IsBackButtonVisible="Collapsed"
                             SelectionChanged="SettingsNavView_SelectionChanged"
                             PaneDisplayMode="Left"
                             IsPaneOpen="True"
                             MinHeight="640"
                             Background="{StaticResource CardDarkBrush}"
                             CornerRadius="12"
                             ExpandedModeThresholdWidth="1"
                             OpenPaneLength="210"
                             CompactPaneLength="56">
                <NavigationView.MenuItems>
                    <NavigationViewItem x:Name="NavGeneral" Content="General" Tag="General">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Home"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavScanning" Content="Scanning" Tag="Scanning">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Find"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavPlatforms" Content="Platforms" Tag="Platforms">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Library"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavPreferences" Content="Preferences" Tag="Preferences">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Setting"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                </NavigationView.MenuItems>
                <NavigationView.Content>
                    <Grid x:Name="SettingsContentHost" Margin="8">
                        <!-- GENERAL PANEL -->
                        <StackPanel x:Name="GeneralPanel" Spacing="16" Visibility="Visible">
                            <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                            <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                <StackPanel Spacing="16">
                                    <TextBlock Text="Application Information" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                    <Grid RowSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Application:" FontWeight="SemiBold" Foreground="#CCCCCC" FontSize="14"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="AppNameText" Text="OptiScaler Manager" Foreground="White" FontSize="14"/>
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Version:" FontWeight="SemiBold" Foreground="#CCCCCC" FontSize="14"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="AppVersionText" Text="1.0.0" Foreground="White" FontSize="14"/>
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Framework:" FontWeight="SemiBold" Foreground="#CCCCCC" FontSize="14"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text=".NET 8 - WinUI 3" Foreground="White" FontSize="14"/>
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Data Folder:" FontWeight="SemiBold" Foreground="#CCCCCC" FontSize="14"/>
                                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                            <TextBlock x:Name="DataFolderText" Text="..." Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                            <Button Content="Open" Style="{StaticResource XboxSecondaryButtonStyle}" Click="OpenDataFolder_Click" Height="32" MinWidth="80"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- SCANNING PANEL -->
                        <StackPanel x:Name="ScanningPanel" Spacing="16" Visibility="Collapsed">
                            <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                            <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                <StackPanel Spacing="16">
                                    <TextBlock Text="Scanning Configuration" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Deep Scan Mode" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Scan subdirectories more thoroughly (slower but more complete)" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <ToggleSwitch x:Name="DeepScanToggle" OnContent="Enabled" OffContent="Disabled"/>
                                    </StackPanel>
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Auto-scan on Startup" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Automatically scan for new games when the app starts" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <ToggleSwitch x:Name="AutoScanToggle" OnContent="Enabled" OffContent="Disabled"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- PLATFORMS PANEL -->
                        <StackPanel x:Name="PlatformsPanel" Spacing="16" Visibility="Collapsed">
                            <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                            <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                <StackPanel Spacing="16">
                                    <TextBlock Text="Gaming Platforms" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                    <TextBlock Text="Enable scanning for the following gaming platforms:" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                    
                                    <!-- Steam -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Steam" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Valve's Steam platform" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="SteamToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="SteamPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeSteamPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- Epic -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Epic Games" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Epic Games Store" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="EpicToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="EpicPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeEpicPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- Xbox -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Xbox" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Xbox Game Pass &amp; Microsoft Store" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="XboxToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="XboxPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeXboxPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- GOG -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="GOG Galaxy" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Good Old Games platform" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="GOGToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="GOGPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeGOGPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- EA -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="EA App" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Electronic Arts launcher" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="EAToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="EAPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeEAPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- Ubisoft -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Ubisoft Connect" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Ubisoft's game platform" FontSize="11" Foreground="#999999"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <ToggleSwitch Grid.Column="0" x:Name="UbisoftToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                            <TextBlock Grid.Column="1" x:Name="UbisoftPathText" Text="Path: Detecting..." FontSize="11" Foreground="#AAAAAA" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                            <Button Grid.Column="2" Content="Change" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ChangeUbisoftPath_Click" Height="32" MinWidth="80"/>
                                        </Grid>
                                    </StackPanel>
                                    
                                    <Rectangle Height="1" Fill="#22FFFFFF"/>
                                    
                                    <!-- Additional Game Folders -->
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Additional Game Folders" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Add extra folders where you have games installed (outside of standard launchers)" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <Grid ColumnSpacing="12">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox Grid.Column="0" x:Name="CustomPathTextBox" PlaceholderText="e.g., D:\Games\MyCustomFolder" Height="36"/>
                                            <Button Grid.Column="1" Content="Browse" Style="{StaticResource XboxSecondaryButtonStyle}" Click="BrowseCustomPath_Click" Height="36" MinWidth="80"/>
                                            <Button Grid.Column="2" Content="Add Folder" Style="{StaticResource XboxButtonStyle}" Click="AddCustomPath_Click" Height="36" MinWidth="100"/>
                                        </Grid>
                                        <TextBlock Text="Added Folders:" FontSize="12" FontWeight="SemiBold" Foreground="#AAAAAA" Margin="0,8,0,4"/>
                                        <ListView x:Name="CustomPathsList" MaxHeight="140" Background="{StaticResource ButtonTertiaryBrush}" CornerRadius="4" Padding="8">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid ColumnSpacing="12">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding}" Foreground="White" VerticalAlignment="Center" FontSize="12"/>
                                                        <Button Grid.Column="1" Content="Remove" Style="{StaticResource XboxSecondaryButtonStyle}" Click="RemoveCustomPath_Click" Tag="{Binding}" Width="70" Height="28" Padding="0" FontSize="11"/>
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- PREFERENCES PANEL -->
                        <StackPanel x:Name="PreferencesPanel" Spacing="16" Visibility="Collapsed">
                            <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                            <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                <StackPanel Spacing="16">
                                    <TextBlock Text="General Preferences" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Start with Windows" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Launch OptiScaler Manager when Windows starts" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <ToggleSwitch x:Name="StartWithWindowsToggle" OnContent="Enabled" OffContent="Disabled"/>
                                    </StackPanel>
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Start Minimized" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Start the application minimized to system tray" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <ToggleSwitch x:Name="StartMinimizedToggle" OnContent="Enabled" OffContent="Disabled"/>
                                    </StackPanel>
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="Enable Notifications" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Show notifications for mod installations and updates" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <ToggleSwitch x:Name="NotificationsToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </NavigationView.Content>
            </NavigationView>

            <!-- Action bar -->
            <Grid Grid.Row="2" ColumnSpacing="12" Background="{StaticResource CardDarkBrush}" CornerRadius="10" Padding="16" Height="72">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button Content="Reset Settings" Style="{StaticResource XboxButtonStyle}" Click="ResetSettings_Click" MinWidth="140"/>
                <Button Grid.Column="1" Content="Clear Cache" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ClearCache_Click" MinWidth="100" Margin="12,0,0,0"/>
                <Button Grid.Column="2" Content="Export Settings" Style="{StaticResource XboxSecondaryButtonStyle}" Click="ExportSettings_Click" MinWidth="130" Margin="12,0,0,0"/>
                <TextBlock Grid.Column="3" x:Name="StatusMessage" Text="Settings are saved automatically" FontSize="12" Foreground="#B3B3B3" VerticalAlignment="Center" Margin="24,0"/>
            </Grid>

            <Rectangle Grid.Row="3" Height="8" Fill="Transparent"/>
        </Grid>
    </ScrollViewer>
</Page>