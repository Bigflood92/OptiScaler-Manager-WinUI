<Page x:Class="OptiScaler.UI.Views.ModConfigPage"
      x:Name="RootPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      Background="Transparent">
    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
        <Grid RowSpacing="24" Padding="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid x:Name="HeaderGrid" Grid.Row="0" Height="110" CornerRadius="12" Background="{StaticResource HeroGradient}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="380"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" VerticalAlignment="Center" Padding="32,0" Spacing="6">
                    <TextBlock Text="Mod Configuration" FontSize="32" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Quick presets and defaults for new OptiScaler installations" FontSize="16" Foreground="#CCFFFFFF"/>
                </StackPanel>
                <Border Grid.Column="1" Background="#22000000" CornerRadius="10" Margin="16" Padding="14" VerticalAlignment="Center">
                    <TextBlock x:Name="SystemInfoText" Text="Detecting..." FontSize="13" Foreground="#DDFFFFFF" TextWrapping="Wrap"/>
                </Border>
            </Grid>

            <!-- Presets (global quick) -->
            <StackPanel x:Name="PresetsBar" Grid.Row="1" Orientation="Horizontal" Spacing="8">
                <Button x:Name="AutoPresetBtn" Content="Auto" Style="{StaticResource XboxSecondaryButtonStyle}" Click="PresetAuto_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Auto-detect GPU and apply optimal settings"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button x:Name="DefaultPresetBtn" Content="Default" Style="{StaticResource XboxButtonStyle}" Click="PresetDefault_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Restore default balanced settings"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button x:Name="PerformancePresetBtn" Content="Performance" Style="{StaticResource XboxButtonStyle}" Click="PresetPerformance_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Maximize performance with FSR 3.1 and frame generation"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button x:Name="BalancedPresetBtn" Content="Balanced" Style="{StaticResource XboxButtonStyle}" Click="PresetBalanced_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Balance between quality and performance"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button x:Name="QualityPresetBtn" Content="Quality" Style="{StaticResource XboxButtonStyle}" Click="PresetQuality_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Maximize visual quality with DLSS"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button x:Name="CustomPresetBtn" Content="Custom" Style="{StaticResource XboxSecondaryButtonStyle}" Click="PresetCustom_Click" MinWidth="95">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Restore previously saved custom settings"/>
                    </ToolTipService.ToolTip>
                </Button>
                <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center" Margin="24,0,0,0">
                    <TextBlock Text="GPU" Foreground="#CCCCCC" FontSize="12" VerticalAlignment="Center"/>
                    <ComboBox x:Name="GpuVendorComboBox" Width="110">
                        <ComboBoxItem Content="Auto" IsSelected="True"/>
                        <ComboBoxItem Content="NVIDIA"/>
                        <ComboBoxItem Content="AMD"/>
                        <ComboBoxItem Content="Intel"/>
                    </ComboBox>
                </StackPanel>
            </StackPanel>

            <!-- Navigation (single column) -->
            <NavigationView Grid.Row="2"
                             x:Name="BasicNavView"
                             PaneTitle="Configuration"
                             IsSettingsVisible="False"
                             IsBackButtonVisible="Collapsed"
                             SelectionChanged="BasicNavView_SelectionChanged"
                             PaneDisplayMode="Left"
                             IsPaneOpen="True"
                             MinHeight="640"
                             Background="{StaticResource CardDarkBrush}"
                             CornerRadius="12"
                             ExpandedModeThresholdWidth="1"
                             OpenPaneLength="210"
                             CompactPaneLength="56">
                <NavigationView.MenuItems>
                    <NavigationViewItem x:Name="NavUpscaling" Content="Upscaling" Tag="Upscaling">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Forward"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavFrameGen" Content="FrameGen" Tag="FrameGen">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Sync"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavInterface" Content="Interface" Tag="Interface">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="ViewAll"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavInstallation" Content="Installation" Tag="Installation">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Download"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavGpu" Content="GPU Compat" Tag="GPU">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Link"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem x:Name="NavAdvanced" Content="Advanced" Tag="Advanced">
                        <NavigationViewItem.Icon><SymbolIcon Symbol="Edit"/></NavigationViewItem.Icon>
                    </NavigationViewItem>
                </NavigationView.MenuItems>
                <NavigationView.Content>
                    <Grid x:Name="BasicContentHost" Margin="8" RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <InfoBar x:Name="ModsInfoBar" Grid.Row="0" IsOpen="False" Severity="Warning" Title="Mods not detected" Message="Download OptiScaler / OptiPatcher to enable full configuration." Margin="0,0,0,4"/>
                        <Grid Grid.Row="1">
                            <!-- UPSCALING PANEL -->
                            <StackPanel x:Name="UpscalingPanel" Spacing="16" Visibility="Visible">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="18">
                                        <TextBlock Text="Upscaling" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <Rectangle Height="1" Fill="#33FFFFFF" Margin="0,4"/>
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Primary Upscaler" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ComboBox x:Name="UpscalerComboBox" HorizontalAlignment="Stretch">
                                                <ComboBoxItem Content="Auto - Let OptiScaler decide" IsSelected="True"/>
                                                <ComboBoxItem Content="DLSS - NVIDIA Deep Learning Super Sampling"/>
                                                <ComboBoxItem Content="XeSS - Intel Xe Super Sampling"/>
                                                <ComboBoxItem Content="FSR 2.2 - AMD FidelityFX Super Resolution 2.2"/>
                                                <ComboBoxItem Content="FSR 3.1 - AMD FidelityFX Super Resolution 3.1"/>
                                            </ComboBox>
                                        </StackPanel>
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Quality Preset" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ComboBox x:Name="QualityComboBox" HorizontalAlignment="Stretch">
                                                <ComboBoxItem Content="Ultra Quality - Minimal upscaling (1.3x)"/>
                                                <ComboBoxItem Content="Quality - Balanced quality (1.5x)" IsSelected="True"/>
                                                <ComboBoxItem Content="Balanced - Good performance (1.7x)"/>
                                                <ComboBoxItem Content="Performance - Higher performance (2.0x)"/>
                                                <ComboBoxItem Content="Ultra Performance - Maximum performance (3.0x)"/>
                                            </ComboBox>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- FRAMEGEN PANEL -->
                            <StackPanel x:Name="FrameGenPanel" Spacing="16" Visibility="Collapsed">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="16">
                                        <TextBlock Text="Frame Generation" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Enable AMD FidelityFX Frame Generation when OptiPatcher is present." FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="Frame Generation" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ToggleSwitch x:Name="FrameGenToggle" OnContent="Enabled" OffContent="Disabled"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- INTERFACE PANEL -->
                            <StackPanel x:Name="InterfacePanel" Spacing="16" Visibility="Collapsed">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="16">
                                        <TextBlock Text="Overlay &amp; Interface" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock Text="Configure the in-game overlay menu and HUD elements" FontSize="12" Foreground="#CCCCCC" TextWrapping="Wrap"/>
                                        
                                        <Rectangle Height="1" Fill="#33FFFFFF" Margin="0,4"/>
                                        
                                        <!-- Overlay Menu -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="Overlay Menu (Insert key)" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock Text="Enable the in-game configuration menu" FontSize="11" Foreground="#999999"/>
                                            <ToggleSwitch x:Name="OverlayMenuToggle" OnContent="Enabled" OffContent="Disabled" IsOn="True"/>
                                        </StackPanel>
                                        
                                        <!-- Menu Scale -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="Menu Scale" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock Text="Adjust the size of the overlay menu (1.0 = 100%)" FontSize="11" Foreground="#999999"/>
                                            <Grid ColumnSpacing="12">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="80"/>
                                                </Grid.ColumnDefinitions>
                                                <Slider x:Name="MenuScaleSlider" Minimum="0.5" Maximum="2.0" Value="1.0" StepFrequency="0.1" TickFrequency="0.5" TickPlacement="BottomRight"/>
                                                <TextBox Grid.Column="1" x:Name="MenuScaleTextBox" Text="1.0" PlaceholderText="1.0"/>
                                            </Grid>
                                        </StackPanel>
                                        
                                        <Rectangle Height="1" Fill="#22FFFFFF"/>
                                        
                                        <!-- FPS Counter -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="FPS Counter" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock Text="Display frames per second on screen" FontSize="11" Foreground="#999999"/>
                                            <ToggleSwitch x:Name="FPSCounterToggle" OnContent="Enabled" OffContent="Disabled"/>
                                        </StackPanel>
                                        
                                        <!-- FPS Position -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="FPS Counter Position" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ComboBox x:Name="FpsPositionComboBox" HorizontalAlignment="Stretch">
                                                <ComboBoxItem Content="Top Left" IsSelected="True"/>
                                                <ComboBoxItem Content="Top Right"/>
                                                <ComboBoxItem Content="Bottom Left"/>
                                                <ComboBoxItem Content="Bottom Right"/>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <Rectangle Height="1" Fill="#22FFFFFF"/>
                                        
                                        <!-- Vertical FOV -->
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="Vertical FOV Override" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock Text="Override camera vertical field of view for FSR (0 = disabled, auto-detect)" FontSize="11" Foreground="#999999"/>
                                            <TextBox x:Name="VerticalFovTextBox" Width="160" PlaceholderText="0" HorizontalAlignment="Left"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- INSTALLATION PANEL -->
                            <StackPanel x:Name="InstallationPanel" Spacing="16" Visibility="Collapsed">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="16">
                                        <TextBlock Text="Installation" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="DLL Filename" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ComboBox x:Name="DllFilenameComboBox" HorizontalAlignment="Stretch">
                                                <ComboBoxItem Content="dxgi.dll" IsSelected="True"/>
                                                <ComboBoxItem Content="d3d12.dll"/>
                                                <ComboBoxItem Content="winmm.dll"/>
                                                <ComboBoxItem Content="version.dll"/>
                                                <ComboBoxItem Content="dbghelp.dll"/>
                                                <ComboBoxItem Content="wininet.dll"/>
                                                <ComboBoxItem Content="winhttp.dll"/>
                                                <ComboBoxItem Content="OptiScaler.asi"/>
                                            </ComboBox>
                                        </StackPanel>
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="Apply Global Config on Install" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ToggleSwitch x:Name="ApplyConfigToggle" IsOn="True" OnContent="Enabled" OffContent="Disabled"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- GPU PANEL -->
                            <StackPanel x:Name="GpuPanel" Spacing="16" Visibility="Collapsed">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="16">
                                        <TextBlock Text="GPU Compatibility" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <StackPanel Spacing="6">
                                            <TextBlock Text="GPU Spoofing" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ToggleSwitch x:Name="SpoofingToggle" OnContent="Enabled" OffContent="Disabled"/>
                                        </StackPanel>
                                        <StackPanel x:Name="SpoofingOptionsPanel" Spacing="6" Visibility="Collapsed">
                                            <TextBlock Text="Spoofed GPU Model" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <ComboBox x:Name="SpoofGPUComboBox" HorizontalAlignment="Stretch">
                                                <ComboBoxItem Content="NVIDIA GeForce RTX 4090" IsSelected="True"/>
                                                <ComboBoxItem Content="NVIDIA GeForce RTX 4080"/>
                                                <ComboBoxItem Content="NVIDIA GeForce RTX 4070"/>
                                            </ComboBox>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- ADVANCED PANEL (lazy placeholder) -->
                            <StackPanel x:Name="AdvancedPanel" Spacing="16" Visibility="Collapsed">
                                <StackPanel.Transitions><TransitionCollection><EntranceThemeTransition/></TransitionCollection></StackPanel.Transitions>
                                <Border Background="{StaticResource ButtonSecondaryBrush}" CornerRadius="6" Padding="18">
                                    <StackPanel Spacing="10">
                                        <TextBlock Text="Advanced Settings" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                        <TextBlock x:Name="AdvancedLoadingText" Text="Loading..." FontSize="12" Foreground="#CCCCCC"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </NavigationView.Content>
            </NavigationView>

            <!-- Action bar -->
            <Grid Grid.Row="3" ColumnSpacing="12" Background="{StaticResource CardDarkBrush}" CornerRadius="10" Padding="16" Height="72">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusMessage" Text="Settings are saved automatically" FontSize="12" Foreground="#B3B3B3" VerticalAlignment="Center"/>
                <Button Grid.Column="1" Content="Documentation" Style="{StaticResource XboxSecondaryButtonStyle}" Click="OpenDocumentation_Click" MinWidth="120"/>
            </Grid>

            <Rectangle Grid.Row="4" Height="8" Fill="Transparent"/>
        </Grid>
    </ScrollViewer>
</Page>